<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Swipe Survey</title>

<style>
  html, body {
    height: 100%;
    margin: 0;
    background: #f5f5f5;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  }

  .bg {
    position: fixed;
    inset: 0;
    background: #f5f5f5;
  }

  .card {
    position: relative;
    max-width: 420px;
    margin: auto;
    top: 15vh;
    background: white;
    border-radius: 24px;
    padding: 32px 24px;
    text-align: center;
    box-shadow: 0 20px 40px rgba(0,0,0,0.08);
  }

  h1 {
    font-size: 28px;
    margin-bottom: 8px;
  }

  .hint {
    color: #888;
    margin-bottom: 12px;
  }

  .arrows {
    font-size: 20px;
    color: #666;
    margin-bottom: 20px;
  }

  .status {
    margin-top: 20px;
    font-weight: 600;
  }
</style>
</head>

<body>
<div class="bg"></div>

<div class="card" id="card">
  <h1 id="question">How are you feeling today?</h1>
  <div class="hint">Swipe to answer</div>
  <div class="arrows">
    ↑ Better &nbsp; → Same &nbsp; ↓ Worse &nbsp; ← Skip
  </div>
  <div class="status" id="status"></div>
</div>

<script>
const ENDPOINT = "const ENDPOINT = "https://script.googleusercontent.com/macros/s/AKfycbyYGG7Fw6H1xuKppS9PoH_lbGuUdSRpwC5zorwd-hjRZtcOA9pjcl024t4b0VXqP3fN9Q";";

let step = 1;
let answers = {};

let startX = 0;
let startY = 0;

const card = document.getElementById("card");
const question = document.getElementById("question");
const status = document.getElementById("status");

card.addEventListener("touchstart", e => {
  startX = e.touches[0].clientX;
  startY = e.touches[0].clientY;
});

card.addEventListener("touchend", e => {
  const dx = e.changedTouches[0].clientX - startX;
  const dy = e.changedTouches[0].clientY - startY;

  if (Math.abs(dx) > Math.abs(dy)) {
    if (dx > 40) handle("SAME");
    else if (dx < -40) handle("SKIP");
  } else {
    if (dy < -40) handle("BETTER");
    else if (dy > 40) handle("WORSE");
  }
});

function handle(value) {
  if (step === 1) {
    answers.q1 = value;

    if (value === "BETTER") {
      step = 2;
      question.innerText = "How much did it improve?";
      document.querySelector(".arrows").innerText =
        "↑ Slight   → Moderate   ↓ Major   ← Skip";
      status.innerText = "";
    } else {
      submit();
    }

  } else if (step === 2) {
    answers.q2 =
      value === "BETTER" ? "SLIGHT" :
      value === "SAME"   ? "MODERATE" :
      value === "WORSE"  ? "MAJOR" :
      "SKIP";

    submit();
  }
}

function submit() {
  status.innerText = "Saving…";

  fetch(ENDPOINT, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      q1: answers.q1 || "",
      q2: answers.q2 || "",
      ua: navigator.userAgent
    })
  })
  .then(r => r.json())
  .then(() => {
    status.innerText = "Saved. Thank you.";
  })
  .catch(() => {
    status.innerText = "⚠ Not saved";
  });
}
</script>
</body>
</html>
