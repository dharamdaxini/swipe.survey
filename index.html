<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Swipe Survey</title>

<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    background: #f4f4f4;
    font-family: system-ui, -apple-system, BlinkMacSystemFont;
    overscroll-behavior: none;
  }

  body {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .card {
    background: white;
    width: 90%;
    max-width: 420px;
    padding: 40px 24px;
    border-radius: 20px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    text-align: center;
    touch-action: none;
  }

  h1 {
    margin-bottom: 12px;
    font-size: 26px;
  }

  .sub {
    color: #666;
    font-size: 16px;
    margin-bottom: 24px;
    line-height: 1.6;
  }

  .status {
    margin-top: 20px;
    font-weight: 600;
    min-height: 24px;
  }

  .error {
    color: #c0392b;
  }

  .success {
    color: #27ae60;
  }
</style>
</head>

<body>

<div class="card" id="card">
  <h1 id="question">How are you feeling today?</h1>

  <div class="sub" id="hint">
    Swipe to answer<br><br>
    ⬆️ BETTER<br>
    ➡️ SAME<br>
    ⬇️ WORSE<br>
    ⬅️ SKIP
  </div>

  <div class="status" id="status"></div>
</div>

<script>
const ENDPOINT = "PASTE_YOUR_EXEC_URL_HERE";

let step = 1;
let q1 = null;
let q2 = null;

let startX = 0;
let startY = 0;

const card = document.getElementById("card");
const question = document.getElementById("question");
const hint = document.getElementById("hint");
const status = document.getElementById("status");

card.addEventListener("touchstart", e => {
  const t = e.touches[0];
  startX = t.clientX;
  startY = t.clientY;
});

card.addEventListener("touchend", e => {
  const t = e.changedTouches[0];
  const dx = t.clientX - startX;
  const dy = t.clientY - startY;

  if (Math.abs(dx) < 30 && Math.abs(dy) < 30) return;

  let action;
  if (Math.abs(dx) > Math.abs(dy)) {
    action = dx > 0 ? "RIGHT" : "LEFT";
  } else {
    action = dy < 0 ? "UP" : "DOWN";
  }

  handleSwipe(action);
});

function handleSwipe(dir) {
  if (step === 1) {
    q1 = mapQ1(dir);
    if (!q1) return;
    step = 2;
    renderQ2();
  } else if (step === 2) {
    q2 = mapQ2(dir);
    if (!q2) return;
    saveData();
  }
}

function mapQ1(dir) {
  if (dir === "UP") return "BETTER";
  if (dir === "RIGHT") return "SAME";
  if (dir === "DOWN") return "WORSE";
  if (dir === "LEFT") return "SKIP";
}

function mapQ2(dir) {
  if (dir === "UP") return "SLIGHT";
  if (dir === "RIGHT") return "MODERATE";
  if (dir === "DOWN") return "MAJOR";
  if (dir === "LEFT") return "SKIP";
}

function renderQ2() {
  question.textContent = "How much did it improve?";
  hint.innerHTML = `
    Swipe to answer<br><br>
    ⬆️ SLIGHT<br>
    ➡️ MODERATE<br>
    ⬇️ MAJOR<br>
    ⬅️ SKIP
  `;
  status.textContent = "";
}

function saveData() {
  status.textContent = "Saving...";
  status.className = "status";

  fetch(ENDPOINT, {
    method: "POST",
    body: JSON.stringify({
      q1,
      q2,
      ua: navigator.userAgent
    })
  })
  .then(r => r.text())
  .then(() => {
    status.textContent = "✓ Saved. Thank you.";
    status.className = "status success";
  })
  .catch(() => {
    status.textContent = "⚠ Not saved";
    status.className = "status error";
  });
}
</script>

</body>
</html>
