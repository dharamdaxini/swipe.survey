<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Swipe Survey</title>

<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    background: #f6f6f6;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    touch-action: none;
  }

  .wrapper {
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .card {
    width: 90%;
    max-width: 420px;
    background: white;
    border-radius: 20px;
    padding: 36px 24px;
    text-align: center;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
  }

  h1 {
    margin: 0;
    font-size: 26px;
  }

  .hint {
    margin-top: 12px;
    color: #777;
    font-size: 15px;
  }

  .arrows {
    margin-top: 18px;
    font-size: 18px;
    color: #555;
    line-height: 1.6;
  }

  .status {
    margin-top: 24px;
    font-weight: 600;
  }

  .error {
    color: #c0392b;
  }

  .success {
    color: #2e7d32;
  }
</style>
</head>

<body>
<div class="wrapper">
  <div class="card">
    <h1 id="question">How are you feeling today?</h1>

    <div class="hint">Swipe to answer</div>

    <div class="arrows" id="arrows">
      ↑ Better<br>
      → Same<br>
      ↓ Worse<br>
      ← Skip
    </div>

    <div class="status" id="status"></div>
  </div>
</div>

<script>
/* ================= CONFIG ================= */

const ENDPOINT = "PASTE_YOUR_EXEC_URL_HERE";

/* ================= STATE ================= */

let step = 1;
let answer1 = null;
let answer2 = null;

let startX = 0;
let startY = 0;

/* ================= TOUCH ================= */

document.addEventListener("touchstart", e => {
  startX = e.touches[0].clientX;
  startY = e.touches[0].clientY;
});

document.addEventListener("touchend", e => {
  const dx = e.changedTouches[0].clientX - startX;
  const dy = e.changedTouches[0].clientY - startY;

  if (Math.abs(dx) < 30 && Math.abs(dy) < 30) return;

  if (Math.abs(dy) > Math.abs(dx)) {
    dy < 0 ? handleSwipe("up") : handleSwipe("down");
  } else {
    dx > 0 ? handleSwipe("right") : handleSwipe("left");
  }
});

/* ================= LOGIC ================= */

function handleSwipe(dir) {
  if (step === 1) {
    if (dir === "up") answer1 = "BETTER";
    if (dir === "right") answer1 = "SAME";
    if (dir === "down") answer1 = "WORSE";
    if (dir === "left") answer1 = "SKIPPED";

    if (answer1 === "BETTER") {
      step = 2;
      showFollowup();
    } else {
      submit();
    }
  }

  else if (step === 2) {
    if (dir === "up") answer2 = "SLIGHT";
    if (dir === "right") answer2 = "MODERATE";
    if (dir === "down") answer2 = "MAJOR";
    if (dir === "left") answer2 = "SKIPPED";

    submit();
  }
}

function showFollowup() {
  document.getElementById("question").innerText = "How much did it improve?";
  document.getElementById("arrows").innerHTML = `
    ↑ Slight<br>
    → Moderate<br>
    ↓ Major<br>
    ← Skip
  `;
}

/* ================= SUBMIT ================= */

function submit() {
  document.getElementById("status").innerText = "Saving…";

  fetch(ENDPOINT, {
    method: "POST",
    body: JSON.stringify({
      q1: answer1,
      q2: answer2 || "",
      ua: navigator.userAgent
    })
  })
  .then(() => {
    document.getElementById("status").innerText = "Saved. Thank you.";
    document.getElementById("status").className = "status success";
  })
  .catch(() => {
    document.getElementById("status").innerText = "Not saved";
    document.getElementById("status").className = "status error";
  });
}
</script>
</body>
</html>
